Python 窗口截图工具 (Window Capture Tool)

版本: v1.0.9
语言: Python 3.x
作者: (dogguoxia)

📖 项目简介

这是一个基于 Python (Tkinter + PyWin32) 开发的轻量级 Windows 窗口截图工具。它允许用户从下拉列表中选择当前打开的应用程序窗口，一键截取并自动保存，无需手动裁剪。

✨ 主要功能

特定窗口截取: 自动识别当前运行的所有可见窗口，排除系统后台进程。

自动命名: 截图自动保存为 test1.png, test2.png 等，防止文件覆盖。

自定义路径: 支持通过 UI 界面选择截图保存的文件夹。

快捷操作:

提供“打开目录”按钮，快速查看截图结果。

提供“刷新”按钮，实时更新窗口列表。

智能交互:

截图时自动隐藏工具本身，避免遮挡。

尝试自动还原并置顶最小化的窗口进行截图。

操作结果通过底部状态栏显示，无弹窗打扰。

悬浮窗设计: 窗口始终保持在最顶层 (Always on Top)，方便操作。

🛠️ 环境依赖与安装

请确保您的系统已安装 Python 3。

1. 安装依赖库

在终端或命令行中运行以下命令（注意：pywin32 包含了 win32gui 等模块）：

pip install Imagegrab

pip install pywin32

📝 版本历史 (Changelog)

文档: 更新项目文档与使用说明。

优化: 整合 UI 布局，确保在不同分辨率下的显示稳定性。

v1.0.9 (当前版本)
调整: 将自动截图的时间间隔调整为 10秒/张。
优化: 进一步优化了 UI 响应速度。

v1.0.8 

(稳定性更新)
修复: 修复了自动截图循环中的逻辑缺陷。
增强: 引入了更强健的异常处理 (try...except...finally) 机制。
在之前的版本中，如果某次截图失败（例如目标窗口突然关闭或最小化无法还原），自动截图线程可能会终止。

v1.0.8 

确保即使单次截图抛出异常，定时器依然会继续运行，尝试在下一个周期进行截图。

v1.0.7

调整: 将自动截图的时间间隔从 5秒 调整为 8秒/张，以适应不需要过高频率的场景。

v1.0.6 (新功能)

新增: 正式引入 自动截图 (Auto Capture) 功能。
交互: 在 UI 上增加了“开始自动截图”按钮，点击后按钮变为“停止自动截图”。
默认设置: 初始版本的自动截图间隔设定为 5秒。

v1.0.5

UI 改进: 新增了功能区的文本提示标签（"选择截图窗口"、"图片保存路径"），提升易用性。

布局调整: 优化了按钮和输入框的间距。

v1.0.4

新功能: 新增“打开目录”按钮，点击可直接打开当前保存路径。

交互优化: 将按钮区重新排列，操作更顺手。

v1.0.3

体验优化: 移除截图成功后的弹窗提示，改为在界面底部 Status Label 显示“已保存: testX.png”或错误信息，实现无打扰截图。

v1.0.2

新功能: 添加路径选择功能，用户可以指定截图保存的文件夹。

v1.0.1

逻辑优化: 实现自动文件命名逻辑 (test1, test2...)，避免重复截图覆盖旧文件。

v1.0.0

基础功能: 实现基础的窗口枚举、选择、截图功能及悬浮窗界面。

⚠️ 注意事项

DPI 缩放: 程序已包含 DPI 感知代码，但在部分高分屏设置下，如果截图区域出现偏差，请检查系统的缩放设置。

管理员权限: 如果尝试截取任务管理器或以管理员身份运行的程序，可能需要以管理员身份运行此脚本。

最小化窗口: 如果目标窗口处于最小化状态，程序会尝试将其还原（Restore）并置顶。

🤝 贡献

欢迎提交 Issue 或 Pull Request 来改进此工具。
